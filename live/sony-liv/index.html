<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SONY LIV</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Fjalla+One&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

<style>
:root{
  --bg:#0d012f;
  --bg2:#1f0c50;
  --card:#1a1a2e;
  --text:#ffffff;
}
.light{
  --bg:#f4f4f4;
  --bg2:#ffffff;
  --card:#ffffff;
  --text:#000000;
}

*{margin:0;padding:0;box-sizing:border-box;font-family:'Fjalla One',sans-serif}

body{
  background:linear-gradient(135deg,var(--bg),var(--bg2));
  color:var(--text);
  transition:.3s;
}

/* HEADER */
header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:14px 18px;
  background:var(--bg);
  box-shadow:0 0 25px rgba(230,18,113,.4);
}

.header-left{
  display:flex;
  align-items:center;
  gap:10px;
}
.logo-img{width:55px}
.site-title{font-size:22px;letter-spacing:2px}

/* RIGHT AREA */
.header-right{
  display:flex;
  align-items:center;
  gap:14px;
}

/* SEARCH (RIGHT SIDE) */
.right-search{
  display:none;
  align-items:center;
  gap:8px;
  background:var(--card);
  padding:6px 14px;
  border-radius:30px;
  width:260px;
  animation:searchIn .25s ease;
}
.right-search input{
  background:transparent;
  border:none;
  outline:none;
  color:var(--text);
  width:100%;
  font-size:14px;
}
.right-search i{cursor:pointer}

@keyframes searchIn{
  from{opacity:0;transform:scale(.9)}
  to{opacity:1}
}

/* GROUPS */
#groups{
  display:flex;
  gap:10px;
  padding:12px;
  overflow-x:auto;
}
.group-btn{
  padding:6px 14px;
  border-radius:20px;
  background:var(--card);
  cursor:pointer;
  white-space:nowrap;
}
.group-btn.active{background:#e61271}

/* GRID */
#listContainer{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
  gap:20px;
  padding:20px;
}

/* CARD */
.box1{animation:card .5s ease forwards}
@keyframes card{
  from{opacity:0;transform:translateY(30px)}
  to{opacity:1}
}
.card{
  background:var(--card);
  border-radius:18px;
  padding:15px;
  text-align:center;
  transition:.4s;
}
.card:hover{
  transform:scale(1.1);
  box-shadow:0 20px 40px rgba(0,0,0,.5);
}
.card img{width:90px;margin:15px auto}
.card h2{font-size:14px}
.card p{font-size:12px;opacity:.7}
a{text-decoration:none;color:inherit}
</style>
</head>

<body>

<header>
  <!-- LEFT -->
  <div class="header-left">
    <img class="logo-img" src="https://play-lh.googleusercontent.com/4VsxQM_JpvxB-qlQaVmYiZMZd9YCUs6AIxUfKADL9iZF-sl2Cmz3vjBebtlV0KI2DNs=w600-h300-pc0xffffff-pd">
    <div class="site-title">SONY LIV</div>
  </div>

  <!-- RIGHT -->
  <div class="header-right">
    <!-- SEARCH BAR -->
    <div class="right-search" id="rightSearch">
      <i class="fa-solid fa-search"></i>
      <input type="search" id="searchInput" placeholder="Search Channel...">
      <i class="fa-solid fa-xmark" id="closeSearch"></i>
    </div>

    <!-- ICONS -->
    <i class="fa-solid fa-search" id="openSearch"></i>
    <i class="fa-solid fa-moon" id="themeBtn"></i>
  </div>
</header>

<div id="groups"></div>
<div id="listContainer"></div>

<script>
const M3U_URL="https://raw.githubusercontent.com/vaathala00/sl/main/stream.m3u";
const container=document.getElementById("listContainer");
const groupsDiv=document.getElementById("groups");
const searchInput=document.getElementById("searchInput");
const rightSearch=document.getElementById("rightSearch");
const openSearch=document.getElementById("openSearch");
const closeSearch=document.getElementById("closeSearch");

let channels=[],currentGroup="All";

/* LOAD M3U */
async function loadM3U(){
  const res=await fetch(M3U_URL);
  const text=await res.text();
  const lines=text.split("\n");
  const groups=new Set(["All"]);

  for(let i=0;i<lines.length;i++){
    if(lines[i].startsWith("#EXTINF")){
      const info=lines[i];
      const id=info.match(/tvg-id="(.*?)"/)?.[1]||"";
      const name=info.split(",").pop().trim();
      const logo=info.match(/tvg-logo="(.*?)"/)?.[1]||"";
      const group=info.match(/group-title="(.*?)"/)?.[1]||"Other";
      groups.add(group);
      channels.push({id,name,logo,group});
    }
  }
  buildGroups([...groups]);
  render();
}

/* GROUPS */
function buildGroups(list){
  groupsDiv.innerHTML="";
  list.forEach(g=>{
    const btn=document.createElement("div");
    btn.className="group-btn"+(g==="All"?" active":"");
    btn.textContent=g;
    btn.onclick=()=>{
      currentGroup=g;
      document.querySelectorAll(".group-btn").forEach(b=>b.classList.remove("active"));
      btn.classList.add("active");
      render();
    };
    groupsDiv.appendChild(btn);
  });
}

/* RENDER */
function render(){
  container.innerHTML="";
  channels.filter(c=>currentGroup==="All"||c.group===currentGroup)
  .forEach(c=>{
    const box=document.createElement("div");
    box.className="box1";
    box.innerHTML=`
      <a href="rd_play.html?id=${c.id}">
        <div class="card">
          <img src="${c.logo}">
          <h2>${c.name}</h2>
          <p>${c.group}</p>
        </div>
      </a>`;
    container.appendChild(box);
  });
}

/* SEARCH */
openSearch.onclick=()=>{
  rightSearch.style.display="flex";
  openSearch.style.display="none";
  searchInput.focus();
};
closeSearch.onclick=()=>{
  rightSearch.style.display="none";
  openSearch.style.display="block";
  searchInput.value="";
  document.querySelectorAll(".box1").forEach(b=>b.style.display="block");
};
searchInput.oninput=e=>{
  const v=e.target.value.toLowerCase();
  document.querySelectorAll(".box1").forEach(b=>{
    b.style.display=b.innerText.toLowerCase().includes(v)?"block":"none";
  });
};

/* THEME */
const themeBtn=document.getElementById("themeBtn");
if(localStorage.theme==="light"){
  document.body.classList.add("light");
  themeBtn.className="fa-solid fa-sun";
}
themeBtn.onclick=()=>{
  document.body.classList.toggle("light");
  const light=document.body.classList.contains("light");
  themeBtn.className=light?"fa-solid fa-sun":"fa-solid fa-moon";
  localStorage.theme=light?"light":"dark";
};

loadM3U();
</script>

</body>
</html>
